@page "/tasks"
@inject ISubjectService SubjectService
@inject NavigationManager Navigation
@using StudyBuddy.Core.Entities
@using StudyBuddy.Services.IServices

<div class="subjects-wrapper">
    <h2 class="subjects-header-title">📘 Choose a Subject</h2>

    @if (Subjects == null)
    {
        <p>Loading...</p>
    }
    else if (!Subjects.Any())
    {
        <p class="text-warning">⚠️ No subjects found.</p>
    }
    else
    {
        <div class="subject-card-grid">
            @foreach (var subj in Subjects)
            {
                <div class="subject-card" @onclick="() => NavigateToSubject(subj.Id)">
                    <div class="subject-card-icon">
                        <i class="@subj.Icon"></i>
                    </div>
                    <div class="subject-card-label">@subj.Name</div>
                </div>
            }
        </div>
    }
</div>

@code {
    private List<Subject> Subjects = new();

    protected override async Task OnInitializedAsync()
    {
        Subjects = (await SubjectService.GetAllAsync()).ToList();
    }

    private void NavigateToSubject(int id)
    {
        Navigation.NavigateTo($"/tasks/subject/{id}");
    }
}
